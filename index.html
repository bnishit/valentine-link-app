<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valentine Link Builder ğŸ’˜</title>
  <style>
    :root{--pink:#ff4f9a;--pink2:#ff8ebc;--lav:#b78dff;--txt:#2e1730;--muted:#745f71}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--txt);background:linear-gradient(180deg,#ffeaf4,#fff7fb);}
    .wrap{max-width:820px;margin:0 auto;padding:18px 14px 28px}
    .top{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
    .chip{font-size:.78rem;padding:7px 10px;border-radius:999px;background:#fff;border:1px solid #ffd2e5;color:#7a5870}
    .card{background:#fff;border:1px solid #ffdcea;border-radius:20px;padding:14px;box-shadow:0 10px 24px rgba(213,42,119,.12)}
    h1{font-size:clamp(1.35rem,6vw,2rem);margin:0 0 4px;line-height:1.1}
    p{margin:0;color:var(--muted)}
    .grid{display:grid;gap:10px;margin-top:12px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    label{font-size:.92rem;font-weight:600}
    input,select{margin-top:6px;width:100%;padding:12px;border:1px solid #f2c8dd;border-radius:12px;font-size:1rem;background:#fff;outline:none}
    input:focus,select:focus{border-color:#d28eff;box-shadow:0 0 0 4px rgba(210,142,255,.15)}
    .btnRow{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    .btn{border:0;border-radius:12px;padding:13px 14px;font-size:1rem;font-weight:800;cursor:pointer}
    .primary{color:#fff;background:linear-gradient(135deg,var(--pink),var(--pink2),var(--lav))}
    .ghost{background:#fff;color:#704f64;border:1px solid #f2c8dd}
    .out{display:none;margin-top:12px;padding:12px;border:1px dashed #f3bdd7;border-radius:12px;background:#fff8fc}
    .link{display:block;margin-top:8px;word-break:break-all;color:#9a225d;font-weight:700;text-decoration:none}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:9px}.sbtn{border:1px solid #f3c7dc;background:#fff;border-radius:10px;padding:8px 10px;font-weight:700}
    .hint{font-size:.82rem;color:#846a7b;margin-top:8px}
    .stats{display:none;margin-top:10px;padding:10px;border:1px solid #f2c8dd;border-radius:10px;background:#fff}
    .stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;text-align:center}
    .num{font-weight:900;color:#8f255c}.lbl{font-size:.75rem;color:#8e7283}
    @media (max-width:640px){.row,.btnRow{grid-template-columns:1fr}.stats-grid{grid-template-columns:1fr 1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <span class="chip">ğŸ’˜ Cute</span>
      <span class="chip">ğŸ“± Mobile-first</span>
      <button id="musicBtn" class="chip" style="cursor:pointer">ğŸµ Music: Off</button>
    </div>

    <main class="card">
      <h1>Build your Valentine link ğŸ’Œ</h1>
      <p>Quick, cute, and made for sharing.</p>

      <div class="grid">
        <div class="row">
          <label>Your name <input id="from" placeholder="Rahul" maxlength="40" /></label>
          <label>Valentineâ€™s name <input id="to" placeholder="Priya" maxlength="40" /></label>
        </div>
        <div class="row">
          <label>Theme <select id="theme"><option value="cute">Cute Pink</option><option value="chaos">Chaotic Fun</option><option value="filmy">Bollywood Filmy</option></select></label>
          <label>Question style <select id="tone"><option value="classic">Will you be my Valentine?</option><option value="funny">Will you accept this premium proposal?</option><option value="filmy">Kya tum meri Valentine banogi/banoge?</option></select></label>
        </div>
        <label>Share hook <select id="hook"><option value="cute">Open this, no cheating ğŸ‘€ğŸ’–</option><option value="filmy">Aaj answer dena padega ğŸ˜ŒğŸŒ¹</option><option value="meme">Warning: impossible question ahead ğŸ˜‚</option></select></label>
      </div>

      <div class="btnRow">
        <button class="btn primary" id="gen">Generate Link</button>
        <button class="btn ghost" id="preview">ğŸ‘€ Preview</button>
      </div>

      <div class="out" id="out">
        <strong>Share this link:</strong>
        <a id="url" class="link" href="#"></a>
        <div class="actions">
          <button class="sbtn" id="copy">ğŸ“‹ Copy</button>
          <button class="sbtn" id="wa">ğŸŸ¢ WhatsApp</button>
          <button class="sbtn" id="tg">âœˆï¸ Telegram</button>
          <button class="sbtn" id="statsBtn">ğŸ“ˆ Refresh Stats</button>
        </div>
        <div class="hint" id="hint"></div>
        <div class="stats" id="stats"><div class="stats-grid"><div><div class="num" id="openN">0</div><div class="lbl">Opens</div></div><div><div class="num" id="yesN">0</div><div class="lbl">Yes</div></div><div><div class="num" id="shareN">0</div><div class="lbl">Shares</div></div><div><div class="num" id="rateN">0%</div><div class="lbl">Yes Rate</div></div></div></div>
      </div>
    </main>
  </div>

<script>
const $=(id)=>document.getElementById(id);
const NS='valentine-link-app-v1';
const fromEl=$('from'),toEl=$('to'),themeEl=$('theme'),toneEl=$('tone'),hookEl=$('hook');
const out=$('out'),urlEl=$('url'),hint=$('hint'),statsBox=$('stats');
let link='',lid='';
const enc=v=>encodeURIComponent((v||'').trim().slice(0,40));
const hooks={cute:'Open this, no cheating ğŸ‘€ğŸ’–',filmy:'Aaj answer dena padega ğŸ˜ŒğŸŒ¹',meme:'Warning: impossible question ahead ğŸ˜‚'};
function mkId(){return Math.random().toString(36).slice(2,9)+Date.now().toString(36).slice(-4)}
function buildLink(id){return `${location.origin}/api/share?from=${enc(fromEl.value||'Someone')}&to=${enc(toEl.value||'You')}&theme=${enc(themeEl.value)}&tone=${enc(toneEl.value)}&hook=${enc(hookEl.value)}&lid=${encodeURIComponent(id)}`}
function buildAsk(id){return `${location.origin}/ask?from=${enc(fromEl.value||'Someone')}&to=${enc(toEl.value||'You')}&theme=${enc(themeEl.value)}&tone=${enc(toneEl.value)}&hook=${enc(hookEl.value)}&lid=${encodeURIComponent(id)}`}
async function count(key){try{const r=await fetch(`https://api.countapi.xyz/get/${NS}/${encodeURIComponent(key)}`);const j=await r.json();return Number(j.value||0)}catch{return 0}}
async function hit(key){try{await fetch(`https://api.countapi.xyz/hit/${NS}/${encodeURIComponent(key)}`)}catch{}}
async function refreshStats(){if(!lid)return; const [o,y,s]=await Promise.all([count(`${lid}:open`),count(`${lid}:yes`),count(`${lid}:share`)]); $('openN').textContent=o; $('yesN').textContent=y; $('shareN').textContent=s; $('rateN').textContent=o?`${Math.round((y/o)*100)}%`:'0%'; statsBox.style.display='block'}
$('gen').onclick=()=>{lid=mkId();link=buildLink(lid);urlEl.href=link;urlEl.textContent=link;out.style.display='block';hint.textContent=`Suggested caption: ${hooks[hookEl.value]}`;refreshStats()}
$('preview').onclick=()=>window.open(buildAsk(lid||mkId()),'_blank')
$('copy').onclick=async()=>{if(!link)return;await navigator.clipboard.writeText(link);$('copy').textContent='âœ… Copied';setTimeout(()=>$('copy').textContent='ğŸ“‹ Copy',1200)}
$('wa').onclick=async()=>{if(!link)return;await hit(`${lid}:share`);window.open(`https://wa.me/?text=${encodeURIComponent(hooks[hookEl.value]+' '+link)}`,'_blank')}
$('tg').onclick=async()=>{if(!link)return;await hit(`${lid}:share`);window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(hooks[hookEl.value])}`,'_blank')}
$('statsBtn').onclick=refreshStats

// lightweight ambient music (user-toggled)
let ctx, osc1, osc2, gain, playing=false, musicTimer;
$('musicBtn').onclick=async()=>{
  if(!playing){
    ctx=new (window.AudioContext||window.webkitAudioContext)();
    if(ctx.state==='suspended') await ctx.resume();
    gain=ctx.createGain(); gain.gain.value=0.06; gain.connect(ctx.destination);
    osc1=ctx.createOscillator(); osc2=ctx.createOscillator();
    osc1.type='sine'; osc2.type='triangle'; osc1.frequency.value=261.63; osc2.frequency.value=329.63;
    osc1.connect(gain); osc2.connect(gain); osc1.start(); osc2.start();
    let t=0; const notes=[261.63,293.66,329.63,392.0,329.63,293.66];
    const loop=()=>{ if(!playing) return; osc1.frequency.setValueAtTime(notes[t%notes.length],ctx.currentTime); osc2.frequency.setValueAtTime(notes[(t+2)%notes.length],ctx.currentTime); t++; musicTimer=setTimeout(loop,650);};
    playing=true; loop(); $('musicBtn').textContent='ğŸµ Music: On';
  } else {
    playing=false; clearTimeout(musicTimer); try{osc1.stop();osc2.stop();ctx.close()}catch{} $('musicBtn').textContent='ğŸµ Music: Off';
  }
}
</script>
</body>
</html>